<div class="graph-panel-container">
  <div class="main-container">
    <button class="close-btn" (click)="closeGraphPanel()">Close</button>
    <!-- Tab links -->
    <div class="tab">
      <button class="tablinks" id="openDataTab" (click)="openTab('Open Data')">Open Data</button>
      <button class="tablinks" id="liveDataTab" (click)="openTab('Live Data')">Live Data</button>
    </div>
    <hr>
    <div class="main">
      <!-- Tab content -->
      <div id="openData" class="tabcontent">
        <div class="controls">

          <!-- Y Axis Selection -->
          <h4>Y Axis</h4>
          <br>
          <mat-form-field>
            <mat-label>Y Dataset</mat-label>
            <mat-select id="yDatasetSelect" [(ngModel)]="ySelectedDataset" (selectionChange)="selectChange($event)">
              <mat-option *ngFor="let dataset of datasets" [value]="dataset">
                {{dataset.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <br>
          <mat-form-field>
            <mat-label>Y Field</mat-label>
            <mat-select [disabled]="!ySelectedDataset" [(ngModel)]="ySelectedField" (selectionChange)="selectChange($event)">
              <ng-container *ngIf="ySelectedDataset">
                <mat-option *ngFor="let field of ySelectedDataset.fields.items" [value]="field">
                  {{field.name}}
                </mat-option>
              </ng-container>
            </mat-select>
          </mat-form-field>

          <!-- X Axis Selection -->
          <h4>X Axis</h4>
          <br>
          <mat-form-field>
            <mat-label>X Dataset</mat-label>
            <mat-select id="xDatasetSelect" [(ngModel)]="xSelectedDataset" (selectionChange)="selectChange($event)">
              <mat-option *ngFor="let dataset of datasets" [value]="dataset">
                {{dataset.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <br>
          <mat-form-field>
            <mat-label>X Field</mat-label>
            <mat-select [disabled]="!xSelectedDataset" [(ngModel)]="xSelectedField" (selectionChange)="selectChange($event)">
              <ng-container *ngIf="xSelectedDataset">
                <mat-option *ngFor="let field of xSelectedDataset.fields.items" [value]="field">
                  {{field.name}}
                </mat-option>
              </ng-container>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="graph">
          <canvas baseChart
            width="400"
            height="400"
            [labels]="chart.labels"
            [datasets]="[{
              data: chart.data
            }]"
            [chartType]="chart.type">
          </canvas>
          <button class="addBtn" (click)="addGraph()">Add Graph to Dashboard</button>
        </div>
      </div>
      <div id="liveData" class="tabcontent">
        <app-live-data-graph-panel></app-live-data-graph-panel>
      </div>
    </div>
  </div>
</div>
